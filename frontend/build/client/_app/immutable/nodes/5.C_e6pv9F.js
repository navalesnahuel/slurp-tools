import{t as _,a as f,b as je}from"../chunks/B9q02PmC.js";import"../chunks/CEYA472p.js";import{X as ye,Y as a,d as e,a7 as W,Z,_ as qe,$ as xe,q as m,a0 as Me,a1 as ae,e as we,a2 as x,a3 as c,a5 as X,a4 as u,a6 as ie}from"../chunks/CkTvmw98.js";import{h as $e,e as I,s as se}from"../chunks/l61C7KQG.js";import{i as F}from"../chunks/lPEFebrr.js";import{a as R,r as G}from"../chunks/B1tgAyqo.js";import{s as ze}from"../chunks/D0lxRREg.js";import{F as Ne,H as ke,D as De,b as re,a as Ee}from"../chunks/Dfkrt3rs.js";import{i as Ie}from"../chunks/DNmyc9OO.js";import{s as Fe,a as Re}from"../chunks/BoBM9_cA.js";import{a as Se}from"../chunks/DnHmEvXm.js";import{i as S,I as Ae}from"../chunks/D7iErLRr.js";import{b as Le}from"../chunks/D2J15UbQ.js";var He=_('<div slot="toolbar-left" class="svelte-1q20jju"><span class="toolbar-label svelte-1q20jju">Resizer</span></div>'),Pe=_('<span class="button-spinner svelte-1q20jju"></span> Applying...',1),Ue=_('<div slot="toolbar-right" class="svelte-1q20jju"><button class="apply-button button-like toolbar-button svelte-1q20jju"><!></button></div>'),We=_('<div class="img-container svelte-1q20jju"><img class="preview-image svelte-1q20jju"></div>'),Ce=_('<p class="placeholder-text svelte-1q20jju">Select an image to start.</p>'),Te=_('<div slot="main-content" class="resize-main-content svelte-1q20jju"><!></div>'),Oe=_('<p class="original-dims-info svelte-1q20jju"> </p> <div class="dimension-inputs svelte-1q20jju"><div class="input-group svelte-1q20jju"><label for="width" class="svelte-1q20jju">Width (px)</label> <input type="number" id="width" min="1" placeholder="Width" class="svelte-1q20jju"></div> <div class="input-group svelte-1q20jju"><label for="height" class="svelte-1q20jju">Height (px)</label> <input type="number" id="height" min="1" placeholder="Height" class="svelte-1q20jju"></div></div> <div class="aspect-toggle svelte-1q20jju"><label title="Maintain aspect ratio when changing dimensions" class="svelte-1q20jju"><input type="checkbox" class="svelte-1q20jju"> <span class="svelte-1q20jju">Lock aspect ratio</span></label></div>',1),Xe=_('<p class="placeholder-text svelte-1q20jju">Loading dimensions...</p>'),Be=_('<p class="placeholder-text svelte-1q20jju">Load an image to see dimensions.</p>'),Ke=_('<div class="sidebar-error-container svelte-1q20jju"><p class="error-message sidebar-error svelte-1q20jju"> </p></div>'),Ve=_('<!> <div class="sidebar-section section-resize svelte-1q20jju"><h4 class="h4-pink svelte-1q20jju">Resize Dimensions</h4> <!></div> <!> <!> <!>',1);function lt(oe,ne){ye(ne,!1);const[le,pe]=Fe(),de=()=>Re(S,"$imageEditorStore",le),B=m(),K=m(),V=m(),n=5e3;let l=m(""),p=m(""),E=m(!0),b=!1,$=m(""),A=m(),C=m(),j=m(),z=m(),o=m(),Y=m();const ve=S.subscribe(t=>{a(A,t.imageUUID),a(C,t.imageUrl),a(j,t.isLoading),a(z,t.isApplying),a(Y,t.errorMessage),e(o)!==t.originalDimensions&&(a(o,t.originalDimensions),e(o)?me(e(o).width,e(o).height):(a(l,""),a(p,"")))});function me(t,s){if(!t||!s)return;b=!0;let i=Math.max(1,Math.min(t,n)),r=Math.max(1,Math.min(s,n));const M=t/s;e(E)&&(t>n||s>n)&&(i>r?(i=n,r=Math.max(1,Math.round(i/M)),r=Math.min(r,n)):(r=n,i=Math.max(1,Math.round(r*M)),i=Math.min(i,n))),a(l,i),a(p,r),W().then(()=>b=!1)}function ce(t){if(!t.target)return;const s=t.target,i={width:s.naturalWidth,height:s.naturalHeight};S.imageLoadComplete(i)}function ue(){S.imageLoadError("Error: Failed to load image preview."),a(l,""),a(p,"")}function J(){if(b||!e(E)||!e(o)||typeof e(l)!="number"||e(l)<=0)return;b=!0,a($,"");let t=Math.max(1,Math.min(e(l),n));t!==e(l)&&a(l,t);const s=e(o).width/e(o).height;if(isNaN(s)||s<=0||e(o).height===0){W().then(()=>b=!1);return}const i=Math.round(t/s),r=Math.max(1,Math.min(i,n));e(p)!==r&&a(p,r),W().then(()=>b=!1)}function he(){if(b||!e(E)||!e(o)||typeof e(p)!="number"||e(p)<=0)return;b=!0,a($,"");let t=Math.max(1,Math.min(e(p),n));t!==e(p)&&a(p,t);const s=e(o).width/e(o).height;if(isNaN(s)||s<=0){W().then(()=>b=!1);return}const i=Math.round(t*s),r=Math.max(1,Math.min(i,n));e(l)!==r&&a(l,r),W().then(()=>b=!1)}function fe(){e(E)&&J()}async function ge(){a($,"");const t=Number(e(l)),s=Number(e(p));if(!(!e(A)||e(j)||e(z))){if(isNaN(t)||isNaN(s)||t<=0||s<=0){a($,"Please enter valid positive dimensions.");return}if(t>n||s>n){a($,`Dimensions cannot exceed ${n}px.`);return}if(!e(o)){a($,"Cannot apply resize: Original dimensions not loaded.");return}await S.applyFilter(i=>Le(i,t,s),"Resize")}}Se(()=>{ve(),S.cleanupBlobUrl()}),Z(()=>(e(l),e(p)),()=>{a(B,typeof e(l)=="number"&&e(l)>0&&e(l)<=n&&typeof e(p)=="number"&&e(p)>0&&e(p)<=n)}),Z(()=>(e(A),e(o),e(j),e(z),e(B)),()=>{a(K,!!e(A)&&!!e(o)&&!e(j)&&!e(z)&&e(B))}),Z(()=>(e($),e(Y)),()=>{a(V,e($)||e(Y))}),qe(),Ie(),$e(t=>{Me.title="Image Resizer - Slurp Tools"}),Ae(oe,{toolTitle:"Image Resizer",toolDescription:"Select an image to resize it.",$$slots:{"toolbar-left":(t,s)=>{var i=He();f(t,i)},"toolbar-right":(t,s)=>{var i=Ue(),r=c(i),M=c(r);{var k=d=>{var v=Pe();ie(),f(d,v)},y=d=>{var v=je("Apply Resize");f(d,v)};F(M,d=>{e(z)?d(k):d(y,!1)})}u(r),u(i),X(()=>{r.disabled=!e(K),R(r,"title",e(K)?"Apply new dimensions":"Enter valid dimensions below")}),I("click",r,ge),f(t,i)},"main-content":(t,s)=>{var i=Te(),r=c(i);{var M=y=>{var d=We(),v=c(d);let w;u(d),X(()=>{R(v,"src",e(C)),R(v,"alt",de().originalFilename||"Image to resize"),R(v,"key",e(C)),w=ze(v,"",w,{opacity:e(j)?.5:1})}),I("load",v,ce),I("error",v,ue),f(y,d)},k=(y,d)=>{{var v=w=>{var T=Ce();f(w,T)};F(y,w=>{e(j)||w(v)},d)}};F(r,y=>{e(C)?y(M):y(k,!1)})}u(i),f(t,i)},"sidebar-content":(t,s)=>{const i=we(()=>s.openFilePicker);var r=Ve(),M=ae(r);Ne(M,{$$events:{openFilePicker(...h){var g;(g=e(i))==null||g.apply(this,h)}}});var k=x(M,2),y=x(c(k),2);{var d=h=>{var g=Oe(),N=ae(g),L=c(N);u(N);var q=x(N,2),D=c(q),H=x(c(D),2);G(H),R(H,"max",n),u(D);var Q=x(D,2),P=x(c(Q),2);G(P),R(P,"max",n),u(Q),u(q);var ee=x(q,2),te=c(ee),O=c(te);G(O),ie(2),u(te),u(ee),X(()=>{se(L,`Current: ${e(o).width??""} x ${e(o).height??""} px`),H.disabled=e(j)||e(z)||!e(o),P.disabled=e(j)||e(z)||!e(o),O.disabled=e(j)||e(z)||!e(o)}),re(H,()=>e(l),U=>a(l,U)),I("input",H,J),re(P,()=>e(p),U=>a(p,U)),I("input",P,he),Ee(O,()=>e(E),U=>a(E,U)),I("change",O,fe),f(h,g)},v=(h,g)=>{{var N=q=>{var D=Xe();f(q,D)},L=q=>{var D=Be();f(q,D)};F(h,q=>{e(A)&&e(j)?q(N):q(L,!1)},g)}};F(y,h=>{e(o)?h(d):h(v,!1)})}u(k);var w=x(k,2);ke(w,{});var T=x(w,2);De(T,{});var _e=x(T,2);{var be=h=>{var g=Ke(),N=c(g),L=c(N,!0);u(N),u(g),X(()=>se(L,e(V))),f(h,g)};F(_e,h=>{e(V)&&h(be)})}f(t,r)}}}),xe(),pe()}export{lt as component};
