import{aP as ee,K as P,J as T,h as H,X as q,Z as h,_ as B,a2 as J,a3 as x,a5 as z,$ as F,Y as d,q as v,d as t,a4 as U}from"./CkTvmw98.js";import{l as K,e as E,s as R}from"./l61C7KQG.js";import{t as I,a as w}from"./B9q02PmC.js";import"./CEYA472p.js";import{i as V}from"./lPEFebrr.js";import{s as W,a as $}from"./B1tgAyqo.js";import{i as N}from"./DNmyc9OO.js";import{p as X,s as Y,a as Z}from"./BoBM9_cA.js";import{i as D}from"./D7iErLRr.js";import{c as te,a as ae}from"./DnHmEvXm.js";import{g as se}from"./D2J15UbQ.js";function we(e,s,n=s){var l=ee();K(e,"input",o=>{var a=o?e.defaultValue:e.value;if(a=A(e)?M(a):a,n(a),l&&a!==(a=s())){var r=e.selectionStart,i=e.selectionEnd;e.value=a??"",i!==null&&(e.selectionStart=r,e.selectionEnd=Math.min(i,e.value.length))}}),(H&&e.defaultValue!==e.value||P(s)==null&&e.value)&&n(A(e)?M(e.value):e.value),T(()=>{var o=s();A(e)&&o===M(e.value)||e.type==="date"&&!o&&!e.value||o!==e.value&&(e.value=o??"")})}function xe(e,s,n=s){K(e,"change",l=>{var o=l?e.defaultChecked:e.checked;n(o)}),(H&&e.defaultChecked!==e.checked||P(s)==null)&&n(e.checked),T(()=>{var l=s();e.checked=!!l})}function A(e){var s=e.type;return s==="number"||s==="range"}function M(e){return e===""?null:+e}function oe(e,s=25){if(!e)return"";if(e.length<=s)return e;const n=e.lastIndexOf("."),l=n!==-1?e.substring(n):"",o=n!==-1?e.substring(0,n):e,a=Math.max(0,s-l.length-(l.length>0?3:0));return a<=0?e.substring(0,s-3)+"...":`${o.length>a?o.substring(0,a):o}...${l}`}var re=I('<p class="filename svelte-1s4yqi3"> </p>'),ne=I('<p class="filename svelte-1s4yqi3"> </p>'),ie=I('<p class="placeholder-text svelte-1s4yqi3">No image selected.</p>'),le=I('<div><!> <button class="button-like change-button svelte-1s4yqi3">Change Image</button></div>');function Ue(e,s){q(s,!1);const[n,l]=Y(),o=()=>Z(D,"$imageEditorStore",n),a=v(),r=v(),i=v(),m=v(),u=v();let p=X(s,"extraClass",8,"");const g=te();function b(){t(i)||(D.changeImage(),g("openFilePicker"))}h(()=>(t(a),t(r),t(i),o()),()=>{(f=>(d(a,f.originalFilename),d(r,f.imageUUID),d(i,f.isLoading)))(o())}),h(()=>t(a),()=>{d(m,oe(t(a)))}),h(()=>t(r),()=>{d(u,t(r)?`${t(r).substring(0,8)}...`:"")}),B(),N();var c=le(),S=x(c);{var _=f=>{var k=re(),L=x(k,!0);U(k),z(()=>{$(k,"title",t(a)),R(L,t(m))}),w(f,k)},j=(f,k)=>{{var L=y=>{var C=ne(),Q=x(C);U(C),z(()=>R(Q,`ID: ${t(u)??""}`)),w(y,C)},G=y=>{var C=ie();w(y,C)};V(f,y=>{t(r)?y(L):y(G,!1)},k)}};V(S,f=>{t(a)?f(_):f(j,!1)})}var O=J(S,2);U(c),z(()=>{W(c,1,`sidebar-section file-management ${p()??""}`,"svelte-1s4yqi3"),O.disabled=t(i)}),E("click",O,b),w(e,c),F(),l()}var ce=I('<div><div class="control-item history-controls svelte-3dzuek"><button class="button-like history-button svelte-3dzuek"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16" class="svelte-3dzuek"><path fill-rule="evenodd" d="M8 3a5 5 0 1 1-4.546 2.914.5.5 0 0 0-.908-.417A6 6 0 1 0 8 2v1z"></path><path d="M8 4.466V.534a.25.25 0 0 0-.41-.192L5.23 2.308a.25.25 0 0 0 0 .384l2.36 1.966A.25.25 0 0 0 8 4.466z"></path></svg> <span class="svelte-3dzuek">Undo</span></button> <button class="button-like history-button svelte-3dzuek"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16" class="svelte-3dzuek"><path fill-rule="evenodd" d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"></path><path d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36-1.966a.25.25 0 0 1 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"></path></svg> <span class="svelte-3dzuek">Redo</span></button></div></div>');function De(e,s){q(s,!1);const n=v(),l=v();let o=X(s,"extraClass",8,""),a=v(),r=v(),i=v();const m=D.subscribe(c=>{d(a,c.imageUUID),d(r,c.isLoading),d(i,c.isApplying)});ae(m),h(()=>(t(a),t(r),t(i)),()=>{d(n,!!t(a)&&!t(r)&&!t(i))}),h(()=>(t(a),t(r),t(i)),()=>{d(l,!!t(a)&&!t(r)&&!t(i))}),B(),N();var u=ce(),p=x(u),g=x(p),b=J(g,2);U(p),U(u),z(()=>{W(u,1,`sidebar-section history-controls-section ${o()??""}`,"svelte-3dzuek"),g.disabled=!t(n),$(g,"title",t(n)?"Undo":"Nothing to undo"),b.disabled=!t(l),$(b,"title",t(l)?"Redo":"Nothing to redo")}),E("click",g,()=>D.undo()),E("click",b,()=>D.redo()),w(e,u),F()}var de=I('<div class="sidebar-section download-section svelte-ekmnog"><button class="button-like save-button svelte-ekmnog">Download Image</button></div>');function Ie(e,s){q(s,!1);const[n,l]=Y(),o=()=>Z(D,"$imageEditorStore",n),a=v(),r=v(),i=v(),m=v(),u=v();function p(){if(!t(u))return;const c=se(t(a)),S=`${c}${c.includes("?")?"&":"?"}t=${Date.now()}`;try{const _=window.open(S,"_blank");_?_.focus():alert("Could not open image in new tab. Please check your popup blocker settings.")}catch(_){alert(`Error opening image: ${_.message}`)}}h(()=>(t(a),t(r),t(i),t(m),o()),()=>{(c=>(d(a,c.imageUUID),d(r,c.imageUrl),d(i,c.isLoading),d(m,c.isApplying)))(o())}),h(()=>(t(a),t(r),t(i),t(m)),()=>{d(u,!!t(a)&&!!t(r)&&!t(i)&&!t(m))}),B(),N();var g=de(),b=x(g);U(g),z(()=>b.disabled=!t(u)),E("click",b,p),w(e,g),F(),l()}export{Ie as D,Ue as F,De as H,xe as a,we as b};
